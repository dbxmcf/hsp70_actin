%\documentclass[tikz,border=10pt]{standalone}
\documentclass{minimal}
\usepackage{ifthen}
\usepackage{tikz}
%\usepackage{pgfmath} 
\usetikzlibrary{calc}
\begin{document}
\newcommand{\pythagwidth}{10cm}
\newcommand{\pythagheight}{\pythagwidth}
\newcounter{blknumber}
\begin{tikzpicture}[darkstyle/.style={circle,draw,fill=gray!10,minimum size=10}]
  \coordinate [label={above left:$A$}] (A) at (0, \pythagheight);
  \coordinate [label={above right:$B$}] (B) at (\pythagwidth, \pythagheight);
  \coordinate [label={below left:$C$}] (C) at (\pythagwidth, 0);

  \coordinate (D1) at (-\pythagheight, \pythagheight + \pythagwidth);
  \coordinate (D2) at (-\pythagheight - \pythagwidth, \pythagwidth);

  %\draw [very thick] (00) -- (10) -- (20) -- (00);
  \draw [very thick] (A) -- (B) -- (C) -- (A);

  %\foreach \x [count=\xxi] in {0,...,9}
    %\foreach \y [count=\yi] in {0,...,8}
      %\draw [dashed] (\xxi,\yi)--(\yi,\x);
      %\draw [dashed] (\xxi,\yi)--(\yi,\x);
\newcommand{\ndiv}{4}
%\newcommand{\nloop}{\ndiv-1}
\newcommand{\nloop}{3}

\foreach \idiv in {1,...,\nloop}
{
    %\coordinate (p0) at (\pythagwidth, 0);
    %\coordinate (p1) at (\pythagwidth, 0);
    \newcommand{\fracp}{\idiv/\ndiv};
    \draw[blue,dashed] ($ (A)!\fracp!(C) $) -- ($ (A)!\fracp!(B) $);
    \draw[blue,dashed] ($ (C)!\fracp!(A) $) -- ($ (C)!\fracp!(B) $);
    %\draw ($ (a) + (0,1) $) -- ($ (b) + (0,1) $);
}

% process labels on the blocks
\def\nrowblocks{2}
\def\nblocks{6}
\def\nrowblocksone{5}
\newcommand{\blksize}{2.5cm}
\coordinate (blklabelstart) at (1.5*\blksize, \pythagheight-0.5*\blksize);

%\def\yelem{0}
%\def\yelemlast{0}
\newcounter{nodenumber}
\pgfmathsetmacro\yelem{0}
\pgfmathsetmacro\yelemlast{0}
\foreach \y [count=\yi] in {0,...,\nrowblocks}
{
    \pgfmathtruncatemacro{\yelemlast}{\yelem};
    \pgfmathtruncatemacro{\yelem}{3-\y};
 \foreach \x [count=\xxi] in {\y,...,\nrowblocks}
 %\foreach \x  in {0,...,\y}
 {
    \stepcounter{nodenumber}
    \pgfmathtruncatemacro{\lblct}{\arabic{nodenumber}-1}
    %\pgfmathtruncatemacro{\lblblock}{\y*\nrowblocks+ Mod(\x,3)};
    %\pgfmathtruncatemacro{\lblblock}{\y*\nrowblocks};
    \pgfmathtruncatemacro{\lblblock}{\y*\nrowblocks+\xxi};
    %\pgfmathtruncatemacro{\accurow}{3*\yi-\yi*(\yi+1)/2};
    %\pgfmathtruncatemacro{\yelemlast}{\yelem};


    \pgfmathtruncatemacro{\accurow}{3*\y*\y-\y*(\y+1)/2};
    \pgfmathtruncatemacro{\tx}{\xxi};
    %\stepcounter{blknumber};
    %\pgfmathtruncatemacro{\lblblock}{\arabic{nodenumber}};
    %\pgfmathtruncatemacro{\lblblock}{\idx + 1};
    %\node [darkstyle]  (\x\y) at ($ (blklabelstart) + (\blksize*\x ,-\blksize*\y) $) {$p_{\yelemlast\tx}$};
    %\node [darkstyle]  (\x\y) at ($ (blklabelstart) + (\blksize*\x ,-\blksize*\y) $){$p_\arabic{nodenumber}$};
    \node [darkstyle]  (\x\y) at ($ (blklabelstart) + (\blksize*\x ,-\blksize*\y) $){$p_{\lblct}$};
    %\node [darkstyle]  (\x\y) at ($ (blklabelstart) + (\blksize*\x ,-\blksize*\y) $) {$p_{\accurow}$};
    %\node [darkstyle]  (\x\y) at ($ (blklabelstart) + (\blksize*\x ,-\blksize*\y) $) {$p_{\lblblock}$};
    %\node [darkstyle]  (\x\y) at ($ (blklabelstart) + (\blksize*\x ,-\blksize*\y) $) {$p_{\lblblock}$};
    %\node [darkstyle]  (\x\y) at ($ (blklabelstart) + (\blksize*\x,-\blksize*\y) $) {$p_{\z}$};
    %\node (\x\y) at ($ (blklabelstart) + (\blksize*\x,-\blksize*\y) $) {$p_{\lblblock}$};
 }
}
% \foreach \x [count=\xxi] in {0,...,\nrowblocksone}
% {
%    %\pgfmathtruncatemacro{\lblblock}{\y*\nrowblocks+\xxi-1};
%    \pgfmathtruncatemacro{\xidx}{\x / 3};
%    \pgfmathtruncatemacro{\yidx}{Mod(\x,3)};
%    %\pgfmathtruncatemacro{\lblblock}{\idx + 1};
%    %\node [darkstyle]  (\xidx\yidx) at ($ (blklabelstart) + (\blksize*\xidx,-\blksize*\yidx) $) {$p_{\x}$};
%    \node [darkstyle]  (\xidx\yidx) at ($ (blklabelstart) + (\xidx,-\yidx) $) {$p_{\x}$};
%    %\node (\x\y) at ($ (blklabelstart) + (\blksize*\x,-\blksize*\y) $) {$p_{\lblblock}$};
% }

\coordinate (trilabelstart) at (0.6*\blksize, \pythagheight-0.35*\blksize);
\newcommand{\ntriangles}{4}
\newcommand{\ntri}{$ \ntriangles -1 $}
\foreach \x in {0,...,3 }
 {
    \pgfmathtruncatemacro{\lbltriangle}{\x / 2 + 6};
    %\newcommand{\lbltriangle}{\x / 2 + 6};
    \pgfmathtruncatemacro{\lblzeroone}{Mod(\x,2)};
    \ifthenelse{0 = \lblzeroone}{\def\lblab{a}}{\def\lblab{b}};
    %\prt
    %\pgfmathtruncatemacro\mymacro{round(\i*100/3)}
    \node [darkstyle]  (\x\x) at ($ (trilabelstart) + (\blksize*\x,-\blksize*\x) $) {$p_{\lbltriangle\lblab}$};
    %\node (\x\x) at ($ (trilabelstart) + (\blksize*\x,-\blksize*\x) $) {$p_{\lbltriangle\lblab}$};
 }

%  \newcommand{\ranglesize}{0.3cm}
%  \draw (A) -- ++ (0, \ranglesize) -- ++ (-\ranglesize, 0) -- ++ (0, -\ranglesize);
%
%  \draw [dashed] (A) -- node [below] {$b$} ++ (-\pythagwidth, 0)
%            -- node [right] {$b$} ++ (0, -\pythagwidth)
%            -- node [above] {$b$} ++ (\pythagwidth, 0)
%            -- node [left]  {$b$} ++ (0, \pythagwidth);
%
%  \draw [dashed] (A) -- node [right] {$c$} ++ (0, \pythagheight)
%            -- node [below] {$c$} ++ (\pythagheight, 0)
%            -- node [left]  {$c$} ++ (0, -\pythagheight)
%            -- node [above] {$c$} ++ (-\pythagheight, 0);
%
%  \draw [dashed] (C) -- node [above left]  {$a$} (B)
%                     -- node [below left]  {$a$} (D1)
%                     -- node [below right] {$a$} (D2)
%                     -- node [above right] {$a$} (C);
\end{tikzpicture}
\end{document}
